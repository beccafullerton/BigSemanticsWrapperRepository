<meta_metadata_repository name="product_and_service"
  package="ecologylab.bigsemantics.generated.library.product_and_service">

  <!-- All non-site-specific wrappers for product/service -->
	<meta_metadata name="labeled_specifications" extends="metadata">
		<scalar name="title" scalar_type="String" hide_label="true" />
		<collection name="specifications" child_type="specification" 
		 hide_label="true" show_expanded_always="true" />
	</meta_metadata>
	
  <meta_metadata name="specification" extends="metadata">
	  <scalar name="name" scalar_type="String" hide="true"/>
	  <scalar name="value" scalar_type="String" use_value_as_label="name" style_name="metadata_italic" />
  </meta_metadata>
	
  <meta_metadata name="commodity" extends="compound_document">
    <scalar name="location" hide="true" />
    <collection name="main_images" layer="3.0"  />
    
    <scalar name="price" scalar_type="String" layer="3.0" style_name="topRight_div"
      schema_org_itemprop="price" >
      <xpath>//*[@itemprop='price']//text()</xpath>      
    </scalar>
  	<collection name="companion_products" label="people_by_with" child_type="commodity"/>
  	<collection name="comparitive_products" label="people_by_instead" child_type="commodity"/>
  	
  	<collection name="product_details" child_scalar_type="String"/>
  	<!-- labeled_specifications is a collection of collection of specs, each with its own label -->
  	
	<collection name="specifications" child_type="specification" />
	<collection name="specifications_table" child_type="labeled_specifications"/>
		
		<scalar name="overall_rating" scalar_type="String" navigates_to="reviews_location" layer="2.0"
      style_name="underTopRight_div" schema_org_itemprop="aggregateRating" />
  	<scalar name="reviews_location" scalar_type="ParsedURL" hide="true" />
  	<scalar name="num_reviews" scalar_type="Int" layer="2.0" style_name="reviewCount_div"
      schema_org_itemprop="reviewCount" />
    <collection name="reviews" child_type="review" layer="0.8" style_name="reviews_div" />
	
    <composite name="business_website" type="compound_document" />
    <composite name="business_address" type="postal_address" />
    <composite name="business_gis_location" type="gis_location" />
  </meta_metadata>


	<meta_metadata name="product" extends="commodity" schema_org_itemtype="http://schema.org/Product">
    <scalar name="model" scalar_type="String" schema_org_itemprop="model" />
  </meta_metadata>

  <meta_metadata name="service" extends="commodity">
    <composite name="business_website" label="website" />
    <composite name="business_address" label="address" />
    <composite name="business_gis_location" label="gis_location" />
    <scalar name="hours" scalar_type="String" schema_org_itemprop="openingHours" />
 	</meta_metadata>
 	<!-- site-specific wrappers -->
 	

  
  

  <meta_metadata name="amazon_product" extends="product" parser="xpath" user_agent_name="chrome">
    <selector url_regex_fragment="http://www.amazon.com/[^/]*/dp/[^/]*" domain="amazon.com" />
    <selector url_regex_fragment="http://www.amazon.co.uk/[^/]*/dp/[^/]*" domain="amazon.co.uk" />
    <selector url_regex_fragment="http://www.amazon.com/gp/product/[^/]*" domain="amazon.com" />
    <selector url_regex_fragment="http://www.amazon.co.uk/gp/product/[^/]*" domain="amazon.co.uk" />

    <example_url url="http://www.amazon.com/Twilight-Saga-Breaking-Two-Disc-Special/dp/B002BWP49C" />
    <example_url url="http://www.amazon.com/Samsung-UN60D7000-60-Inch-1080p-Silver/dp/B004QFGGTY" />
    <example_url url="http://www.amazon.com/Deathly-Hallows-Movie-Only-Edition-UltraViolet/dp/B005O30Y5Y" />
    <example_url url="http://www.amazon.com/Acer-C720-Chromebook-11-6-Inch-2GB/dp/B00FNPD1VW/" />
    <example_url url="http://www.amazon.com/Discovery-Daft-Punk/dp/B000059MEK" />

    <filter_location strip_prefix="/ref=" />

    <scalar name="title">
      <xpath>//h1[@id='title' or @class='parseasinTitle ']</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//meta[@name='description']/@content</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@id='actualPriceValue' or (contains(@class, 'a-size-medium') and contains(@class, 'price'))]</xpath>
    </scalar>
    <composite name="department" type="compound_document">
      <xpath>//*[@id='nav-subnav']/li[1]/a</xpath>
      <scalar name="title">
        <xpath>.</xpath>
      </scalar>
      <scalar name="location" hide="true">
        <xpath>./@href</xpath>
      </scalar>
    </composite>
    <collection name="main_images">
      <xpath>//img[@id='main-image']</xpath>
      <xpath>//img[@id='landingImage']</xpath>
      <xpath>//div[@id='imageBlock']//img</xpath>
      <scalar name="location">
        <xpath>./@data-old-hires</xpath>
        <xpath>./@src</xpath>
      </scalar>
    </collection>

    <def_var name="reviews_span" type="node">
      <xpath>//div[@id='averageCustomerReviews']</xpath>
      <xpath>//span[@ref='dp_top_cm_cr_acr_pop_']</xpath>
    </def_var>
    <scalar name="overall_rating" context_node="reviews_span">
      <xpath>.//span[1]/@title</xpath>
    </scalar>
    <scalar name="reviews_location" context_node="reviews_span">
      <xpath>./a/@href</xpath>
    </scalar>

    <collection name="reviews">
      <xpath>//div[@id='revMHRL']/div[@id]</xpath>
      
      <scalar name="rating">
        <xpath>.//*[contains(@title, '5 stars')]/@title</xpath>
     	<regex_op regex=".0 out of 5" replace="" />
      </scalar>
      <scalar name="description">
        <xpath>./div[@id]/div</xpath>
      </scalar>
      <scalar name="title">
        <xpath>.//span[@class='a-size-base a-text-bold']</xpath>
      </scalar>
    </collection>

    <composite name="bestseller_list_rank" type="amazon_list" label="bestseller_list">
      <xpath>//li[@id='SalesRank']</xpath>
      <scalar name="title">
        <xpath>.//b/a</xpath>
      </scalar>
      <scalar name="location" hide="true">
        <xpath>.//b/a/@href</xpath>
      </scalar>
      <scalar name="overall_rating" label="rank">
        <xpath>./ul/li/span[@class='zg_hrsr_rank']</xpath>
      </scalar>
    </composite>

    <collection name="companion_products" child_type="amazon_product">
<!--       <xpath>//div[@id='vtpsims']/ul/li</xpath> -->
<!-- 	  <xpath>//div[@class='shoveler-content']</xpath> -->
	  <xpath>//div[starts-with(@data-ref,'pd_sim_')]</xpath>
	  
      <scalar name="location">
        <xpath>.//a/@href</xpath>
<!--         <xpath>.//a[@class='sim-img-title']/@href</xpath> -->
       </scalar>
      <scalar name="title">
        <xpath>./a</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//*[@class='price']/text()</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>.//span[@class='rating-stars']//span[@title]/@title</xpath>
      </scalar>
      <!-- would like to use thumbnails here -->
      <collection name="main_images" >
      	<xpath>./a//img</xpath>
      	<scalar name="location">
      		<xpath>./@src</xpath>
      	</scalar>
      </collection>
    </collection>
 
    <collection name="list_mania" child_type="compound_document">
      <xpath>//li//td/a/img</xpath>
      <scalar name="location">
        <xpath>../@href</xpath>
      </scalar>
      <scalar name="title">
        <xpath>./@alt</xpath>
      </scalar>
    </collection>

    <collection name="specifications">
      <xpath>//div[@class='secHeader']/following-sibling::div[1]//tbody/tr[not(position() = last())]</xpath>
      <xpath>//div[@id='technical-data' or @id='detail-bullets']//ul/li</xpath>
    	<xpath>//table[@id='technical-details-table']/tbody/tr</xpath>
    	 <scalar name="name">
          <xpath>./td[1]</xpath>
          <xpath>./b</xpath>
        </scalar>
        <scalar name="value">
          <xpath>./td[2]//div[@id='averageCustomerReviewRating']</xpath>
          <xpath>./td[2]</xpath>
          <xpath>.//span[contains(@class, 'asinReviewsSummary')]//span[@title]</xpath>
          <xpath>.</xpath>
          <regex_op regex="^[^:]+:" replace="" />
        </scalar>
    </collection>
  

    <semantic_actions>
      <reselect_meta_metadata_and_extract name="amazon_item" />
      <if>
        <not_null value="amazon_item" />
        <add_mixin object="amazon_item" mixin="metadata"/>
      </if>
    </semantic_actions>
  </meta_metadata>




  
  <meta_metadata name="amazon_list" extends="creative_work">
    <filter_location strip_prefix="/ref=" />

    <collection name="items" child_type="amazon_product" />
  </meta_metadata>


  <meta_metadata name="amazon_wish_list" type="amazon_list" parser="xpath"
    user_agent_name="firefox">
    <selector url_path_tree="http://www.amazon.com/gp/registry/wishlist" />
    <selector url_path_tree="http://www.amazon.co.uk//gp/registry/wishlist" />
    <example_url url="http://www.amazon.com/gp/registry/wishlist/ref=wish_list" />

    <collection name="items">
      <xpath>//td[@class='lineItemMainInfo']</xpath>
      <scalar name="title">
        <xpath>.//span[@class='small productTitle']</xpath>
      </scalar>
      <scalar name="location">
        <xpath>.//span[@class='small productTitle']/a/@href</xpath>
      </scalar>
    </collection>
  </meta_metadata>


  <meta_metadata name="amazon_list_mania" type="amazon_list" parser="xpath"
    user_agent_name="firefox">
    <selector url_regex="http://www.amazon.com/[^/]*/lm/.*" domain="amazon.com" />
    <selector url_regex="http://www.amazon.co.uk/[^/]*/lm/.*" domain="amazon.co.uk" />
    <example_url url="http://www.amazon.com/Cook-Books-amp-more/lm/R1PADW7FZALCHA/" />

    <scalar name="title">
      <xpath>//h1[@class='largeTitle']</xpath>
    </scalar>
    <collection name="items" child_type="amazon_product">
      <xpath>//td[@class='listItem']/table/tbody</xpath>
      <scalar name="title">
        <xpath>.//strong/a</xpath>
      </scalar>
      <scalar name="location">
        <xpath>.//strong/a/@href</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//span[@class='rpSmall']/span[1]</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>.//span[@class='crAvgStars']//img/@title</xpath>
      </scalar>
    </collection>
  </meta_metadata>
  
  <meta_metadata name="amazon_bestseller_list" type="amazon_list" parser="xpath"
    user_agent_name="chrome">
    <selector url_path_tree="http://www.amazon.com/gp/bestsellers" />
    <selector domain="amazon.com" url_regex="http://www.amazon.com/[^/]*/zgbs/.*" />
    <example_url url="http://www.amazon.com/gp/bestsellers/books/6" />
	
    <filter_location strip_prefix="/ref=" />
    
    <scalar name="title">
      <xpath>//h1[@id='zg_listTitle']/span</xpath>
    </scalar>
    <collection name="items">
      <xpath>//div[@class='zg_itemImmersion']</xpath>
      <scalar name="title">
        <xpath>.//div[@class='zg_title']/a</xpath>
      </scalar>
      <scalar name="location">
        <xpath>.//div[@class='zg_title']/a/@href</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//div[@class='zg_price']//strong[@class='price']</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>.//div[@class='zg_reviews']//span[contains(@class,'swSprite')]</xpath>
      </scalar>
      
      <collection name="main_images">
      	<xpath>//div[@class='zg_image']//a</xpath>
      	<scalar name="location">
      		<xpath>.//img/@src</xpath>
      	</scalar>
      </collection>
    </collection>
  </meta_metadata>


  <meta_metadata name="amazon_bestseller_list_uk" type="amazon_list" parser="xpath"
    user_agent_name="firefox">
    <selector url_path_tree="http://www.amazon.co.uk/gp/bestsellers" />
    <example_url url="http://www.amazon.co.uk/gp/bestsellers/books/515344" />

    <filter_location strip_prefix="/ref=" />

    <scalar name="title">
      <xpath>//h1[@id='zg_listTitle']/span</xpath>
    </scalar>
    <collection name="items">
      <xpath>//div[@class='zg_itemImmersion']</xpath>
      <scalar name="title">
        <xpath>.//div[@class='zg_title']/a</xpath>
      </scalar>
      <scalar name="location">
        <xpath>.//div[@class='zg_title']/a/@href</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//div[@class='zg_price']//strong[@class='price']</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>.//div[@class='zg_reviews']//span[contains(@class,'swSprite')]</xpath>
      </scalar>
    </collection>
  </meta_metadata>

  <meta_metadata name="amazon_search_list" type="amazon_list" parser="xpath"
    user_agent_name="chrome">
    <selector domain="amazon.com" url_regex="http://www.amazon.com/s[/?].*" />
    <example_url url="http://www.amazon.com/s/ref=nb_sb_noss_1?url=search-alias%3Daps&amp;field-keywords=ps4" />

    <scalar name="title">
      <xpath>//title</xpath>
    </scalar>
    <collection name="items">
      <xpath>//div[@id='result_0' or @id='result_1' or @id='result_2' or @id='result_3' or @id='result_4' or @id='result_5' or @id='result_6' or @id='result_7' or @id='result_8' or @id='result_9' or @id='result_10' or @id='result_11' or @id='result_12' or @id='result_13' or @id='result_14' or @id='result_15']</xpath>   <!-- or @id='result_1' or @id='result_2' or @id='result_3' or @id='result_4' or @id='result_5' -->
      <scalar name="title">
        <xpath>.//a[@class='title']/span/@title</xpath>
      </scalar>
      <scalar name="location">
        <xpath>//a[@class='title']/@href</xpath>
      </scalar>
      <scalar name="price">
        <xpath>//li[@class='newp']//span[@class='bld lrg red']</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>//span[@class='a-declarative']//a/@alt</xpath>
      </scalar>
      <collection name="main_images">
        <xpath>.//div[@class='imageBox']/img</xpath>
        <scalar name="location">
          <xpath>//div[@class='imageBox']/img/@src</xpath>
        </scalar>
      </collection>
    </collection>
  </meta_metadata>


  
 




  <meta_metadata name="apple_iProduct" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_regex="http://store.apple.com/us/buy-[a-z]*/[a-z0-9-]*\?.*" domain="apple.com"/>

    <example_url url="http://store.apple.com/us/buy-ipad/ipad-air?product=MD786LL/A&amp;step=accessories" />
    <example_url url="http://store.apple.com/us/buy-iphone/iphone5c?cppart=UNLOCKED/US&amp;product=ME495LL/A&amp;step=accessories" />

    <scalar name="title">
      <xpath>//div[@class='section section-product-title']/h3/text()</xpath>
    </scalar>
    
    <collection name="product_details">
    	<xpath>//div[@class='feature media-block']//p/text()</xpath>
    </collection>

    <collection name="main_images">
      <xpath>//img[@class='hero-img hero-img ir']</xpath>
      <scalar name="location">
        <xpath>./@src</xpath>
      </scalar>
    </collection>
  </meta_metadata>


  <meta_metadata name="apple_product_mac" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_regex="http://store.apple.com/us/buy-mac.*" domain="apple.com"/>
    <example_url url="http://store.apple.com/us/buy-mac/imac?product=ME087LL/A&amp;step=config" />

    <scalar name="title">
      <xpath>//h1[@class='title']</xpath>
      <regex_op regex="Configure your" replace="" />
    </scalar>
    <scalar name="price">
      <xpath>//p[@itemprop='price']</xpath>
    </scalar>

    <collection name="main_images">
      <xpath>//img[@class='hero-img hero-img ir']</xpath>
      <scalar name="location">
        <xpath>./@src</xpath>
      </scalar>
    </collection>

    <collection name="product_details">
      <xpath>//div[@class='section']/ul[@class='specs-list']/li</xpath>
    </collection>
  </meta_metadata>

	  
  <meta_metadata name="apple_product_accessory" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_path_tree="http://store.apple.com/us/product/" />
    <example_url url="http://store.apple.com/us/product/H9345LL/A/hp-photosmart-5520-e-all-in-one-printer?fnode=000105072b" />

    <scalar name="title">
      <xpath>//div[@class='action-card']//div[@id='title']/h1[@itemprop='name']/text()</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@itemprop='price']</xpath>
    </scalar>

    <collection name="main_images">
      <xpath>//div[@class='materializer draggable']/figure/img</xpath>
      <scalar name="location">
        <xpath>./@src</xpath>
      </scalar>
    </collection>

    <scalar name="overall_rating">
      <xpath>//div[contains(@class, 'product-rating-wrapper')]//span[@itemprop='ratingValue']/text()
      </xpath>
      <regex_op regex="$" replace=" out of 5" />
    </scalar>
    <scalar name="description">
      <xpath>//li[@id='overview-applerecommends']//div[@class='bkg-none']/text()</xpath>
    </scalar>

    <collection name="product_details" >
      <xpath>//div[@class='group-image-none clearfix']//p</xpath>
        <xpath>//li[@id='overview-highlights]//ul[@class='pbl bulleted']/li</xpath>
    </collection>
    
    <collection name="specifications">
      <xpath>//li[@id='overview-techspecs']//ul[@class='pbl bulleted']/li</xpath>
      <scalar name="name">
      	<xpath>substring-before(., ':')</xpath>
      </scalar>
      		<scalar name="value" >
				<xpath>substring-after(., ':')</xpath>
			</scalar>    
    </collection>

    <collection name="reviews">
      <xpath>//div[@class='reviews']//div[@id='most-useful-reviews']/ul[@class='review-list']/li
      </xpath>
      <scalar name="title">
        <xpath>.//h3[@class='summary']/text()</xpath>
      </scalar>
      <scalar name="rating">
        <xpath>.//div[@itemprop='reviewRating']//span[@itemprop='ratingValue']/text()</xpath>
        <regex_op regex="$" replace=" out of 5" />
      </scalar>
      <scalar name="description">
        <xpath>.//p[@itemprop='reviewBody']/span[@class='more-text']/text()</xpath>
      </scalar>
    </collection>

    <collection name="companion_products" child_type="apple_product_accessory">
      <xpath>//div[@id='navigation']//div[@class='tile-body']</xpath>
      <scalar name="location">
        <xpath>./h3/a/@href</xpath>
      </scalar>
      <scalar name="title">
        <xpath>./h3/a/text()</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//div[@class='price']/span/text()</xpath>
      </scalar>
    </collection>
  </meta_metadata>
 	
 	
  <meta_metadata name="bestbuy_product" extends="product" parser="xpath"
    user_agentname="firefox">
    <selector url_path_tree="http://www.bestbuy.com/site/" domain="bestbuy.com" />
    <example_url
      url="http://www.bestbuy.com/site/samsung-60-class-60-diag--led-1080p-120hz-smart-hdtv/7827055.p" />
    <example_url
      url="http://www.bestbuy.com/site/42-class-42-diag--led-1080p-120hz-hdtv/8976043.p;jsessionid=24CDBE3978F5952F7E9C65D34D5FB08A.bbolsp-app01-115?id=1218960132416&amp;skuId=8976043&amp;st=categoryid$abcat0101000&amp;cp=1&amp;lp=1"/>
    <scalar name="title">
      <xpath>//*[@id='sku-title']/h1</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//*[@class='item-price']/text()</xpath>
    </scalar>
    <scalar name="overall_rating">
      <xpath>//*[@class='average-score' and @itemprop='ratingValue']/text()</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//*[@id='long-description']/text()</xpath>
    </scalar>

    <collection name="features" child_type="specification">
      <xpath>//*[@id='features']/div[@class='feature']</xpath>
      <scalar name="name" >
        <xpath>./h4/text()</xpath>
      </scalar>
      <scalar name="value">
        <xpath>./p/text()</xpath>
      </scalar>

    </collection>


    <collection name="whats_included" child_scalar_type="String">
      <xpath>//*[@id='included-items']/ul/li/text()</xpath>
     
    </collection>

    <collection name="specifications">
      <xpath>//*[@id='specs-sample']/ul/li</xpath>
      <scalar name="name">
        <xpath>./span[@class='spec-label']/text()</xpath>
      </scalar>
      <scalar name="value">
        <xpath>./text()</xpath>
      </scalar>
    </collection>
    <collection name="companion_products">
      <xpath>(//*[@id='productList'])[1]/li</xpath>
      <scalar name="title">
        <xpath>./a[2]/text()</xpath>
      </scalar>
      <scalar name="location">
        <xpath>./a[2]/@href</xpath>
      </scalar>
    </collection>

    <collection name="comparitive_products">
      <xpath>(//*[@id='productList'])[2]/li</xpath>
      <scalar name="title">
        <xpath>./a[2]/text()</xpath>
      </scalar>
      <scalar name="location">
        <xpath>./a[2]/@href</xpath>
      </scalar>
    </collection>
  </meta_metadata>
 	
  <meta_metadata name="ebay_product" extends="product" parser="xpath" user_agent_name="chrome">
    <selector url_path_tree="http://www.ebay.com/itm/" />
    <example_url
      url="http://www.ebay.com/itm/HomCom-Brown-Square-Microfiber-Storage-Ottoman-Footstool-Foot-Rest-Stool-Cube-/111078764834" />
    <scalar name="title">
      <xpath>//meta[@property='og:title']/@content</xpath>
    </scalar>
    <scalar name="item_condition" scalar_type="String">
      <xpath>//div[@class='u-flL condText']</xpath>
    </scalar>
    <scalar name="availability" scalar_type="String">
      <xpath>//span[@id='qtySubTxt']/span</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@itemprop='price']</xpath>
    </scalar>

    <composite name="seller" type="compound_document">
      <scalar name="name" type="String">
        <xpath>//span[@class='mbg-nw']</xpath>
      </scalar>
      <scalar name="feedback" type="Integer">
        <xpath>//span[@class='mbg-l']/a</xpath>
      </scalar>
      <scalar name="positive_feedback" type="String">
        <xpath>//div[@id='si-fb']</xpath>
      </scalar>
    </composite>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//meta[@property='og:image']/@content</xpath>
      </scalar>
    </collection>
  </meta_metadata>
 

  <meta_metadata name="etsy_product" extends="product" parser="xpath" user_agent_name="firefox">
    <selector url_path_tree="http://www.etsy.com/listing/" domain="etsy.com" />

    <example_url
      url="http://www.etsy.com/listing/117020598/new-york-continuous-arm-windsor-chair-by?ref=fp_treasury_8" />

    <scalar name="title">
      <xpath>//span[@itemprop='name']</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//meta[@property='og:description']/@content</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//meta[@property='etsymarketplace:price']/@content</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//meta[@property='og:image']/@content</xpath>
      </scalar>
    </collection>

  </meta_metadata> 
 
  <meta_metadata name="ikea_mobile_product" type="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_path_tree="http://m.ikea.com/us/en/catalog/products/" domain="ikea.com" />
    <example location="http://m.ikea.com/us/en/catalog/products/art/50058376/" />

    <scalar name="title">
      <xpath>//title</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//div[@class='ikea-pip ui-content']/ul[1]/li[5]/div/</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@itemprop='price']/span</xpath>
    </scalar>

    <composite name="image" type="image">
      <scalar name="location">
        <xpath>//div[@class='ikea-pip-fullImageWrapper']/img/@src</xpath>
      </scalar>
    </composite>

  </meta_metadata>
  
  
  
	
  <meta_metadata name="ikea_product" extends="product" parser="xpath" user_agent_name="chrome">
<!--     <selector url_regex_fragment="http://www.ikea.com/us/en/catalog/products/[^/]*" domain="ikea.com" /> -->
    <selector url_path_tree="http://www.ikea.com/us/en/catalog/products/" />

    <example_url location="http://www.ikea.com/us/en/catalog/products/60204805/" />
    <example_url location="http://www.ikea.com/us/en/catalog/products/S09906060/" />

    <scalar name="title">
      <xpath>//h1</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//*[@itemprop='description']</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//*[@itemprop='price']</xpath>
   </scalar>
    
    <scalar name="model">
      <xpath>//*[@itemprop='productID']</xpath>
    </scalar>
    
    <collection name="dimensions" child_type="specification" >
	   	<xpath>//div[@id='imperial']//text()</xpath>
			<scalar name="name">
				<xpath>substring-before(., ':')</xpath>
			</scalar>    
			<scalar name="value" >
				<xpath>substring-after(., ':')</xpath>
			</scalar>    
    </collection>
	
    <scalar name="weight" scalar_type="string">
    	<xpath>substring-after(//div[@id='packageInfo']//text()[contains(., 'lb')], ':')</xpath>
    </scalar>
    
<!--    <collection name="more_models" child_type="ikea_product">
    	<xpath>//div[@id='modelVisibleConatiner']//div[@class='borderMar']</xpath>
    	
    	<scalar name="location">
    		<xpath>./a/@href</xpath>
    	</scalar>
    	
    	<composite name="thumbnail">
    		<xpath>./a/img</xpath>
    		<scalar name="location">
    			<xpath>./@src</xpath>
    		</scalar>
    	</composite>
    </collection>
 -->	
<!--     <collection name="coordinating_products" child_type="ikea_product"> -->
<!--     </collection> -->
    
		<collection name="specifications" label="details" >
   		<xpath>//div[@id='custMaterials']//text()</xpath>
     	<xpath>//div[@id='custBenefit']/div</xpath>
     	<xpath>//div[@id='goodToKnow']/text()[(preceding::br)]</xpath>
			<scalar name="name">
				<xpath>substring-before(., ':')</xpath>
			</scalar>    
			<scalar name="value" >
				<xpath>substring-after(., ':')</xpath>
			</scalar>    
    </collection>
    
		<collection name="departments" child_type="ikea_department" >
			<xpath>//ul[@id='breadCrumbs']//a</xpath>
	<!-- 		<xpath>//ul[@id='breadCrumbs']/li[not(@class='divider')]</xpath> -->
			<scalar name="title" style_name="metadata_normal" >
				<xpath>.//text()</xpath>
			</scalar>
			<scalar name="location" >
				<xpath>./@href</xpath>
			</scalar>
		</collection>

  </meta_metadata>
  
  <meta_metadata name="ikea_department" extends="compound_document" parser="xpath" user_agent_name="chrome">
     <selector url_path_tree="http://www.ikea.com/us/en/catalog/categories/departments/" domain="ikea.com" />
     <example location="http://www.ikea.com/us/en/catalog/categories/departments/bathroom/20720/" />
     
     <collection name="products" child_type="ikea_product" >   
     	<xpath>//div[@class='threeColumn product ']</xpath>
  	
  		<scalar name="location">
  			<xpath>.//a[@class='productLink']/@href</xpath>
  		</scalar>
  		<scalar name="title" style_name="metadata_normal">
  			<xpath>concat(.//div[@class='productTitle floatLeft'], ' ', .//div[@class='productDesp'])</xpath>
  		</scalar>
  		<scalar name="description">
  			<xpath>.//div[@class='productDesp']</xpath>
  		</scalar>
  		<scalar name="price">
  			<xpath>.//div[@class='price regularPrice']</xpath>
  		</scalar>
   		<collection name="main_images" >
	  		<xpath>.//a[@class='productLink']/img</xpath>
	  		<scalar name="location">
	  			<xpath>./@src</xpath>
	  		</scalar>
  		</collection>
  		
  	</collection>

  </meta_metadata>
  
  
  <meta_metadata name="newegg_product" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_stripped="http://www.newegg.com/Product/Product.aspx" />
    <example_url url="http://www.newegg.com/Product/Product.aspx?Item=N82E16813128532" />
    <example_url url="http://www.newegg.com/Product/Product.aspx?Item=N82E16834257878" />
    <scalar name="title">
      <xpath>//div[@class='wrapper']/h1/span</xpath>
    </scalar>
    <collection name="main_images">
      <scalar name="location">
        <xpath>//span[@class='mainSlide']/img/@src</xpath>
        <xpath>//span[@class='mainSlide']/@imgzoompic</xpath>
      </scalar>
    </collection>
    <!-- This appears to be a newegg specific item number, not a general model number -->
    <scalar name="item_number" scalar_type="String">
      <xpath>//div[@id='bcaBreadcrumbTop']/dl/dd[position() = last()]/em</xpath>
    </scalar>
    <scalar name="overall_rating">
      <xpath>//div[@itemprop='aggregateRating']//img/@title</xpath>
    </scalar>
    <scalar name="num_reviews">
      <xpath>//span[@itemprop='reviewCount']</xpath>
    </scalar>
    
    <collection name="reviews">
      <xpath>//table[@class='grpReviews']/tbody/tr</xpath>

<!-- 	  <def_var name="rating_alt" type="node"> -->
<!-- 	      <xpath>.//span[@class='itmRating']/img/@alt</xpath> -->
<!-- 	  </def_var> -->
      <scalar name="rating" >
<!--       <scalar name="rating" context_node="rating_alt"> -->
<!--         <xpath>substring-before(.//span[@class='itmRating']/img/@alt, 'out of ')</xpath> -->
<!--         <xpath>substring-before(.//span[@class='itmRating']/img/@alt, 'out of ')</xpath> -->
        <xpath>.//span[@class='itmRating']/img/@alt</xpath>
      	<regex_op regex="out of 5" replace="" />
      </scalar>
      <scalar name="title">
        <xpath>.//h3/text()</xpath>
      </scalar>
      <scalar name="description">
        <xpath>.//div[@class='details']/p</xpath>
      </scalar>
    </collection>
    
    <collection name="product_details" child_scalar_type="string">
      <xpath>//ul[@id='grpBullet_']/li/text()</xpath>
    </collection>
    
    <collection name="features" child_scalar_type="string">
      <xpath>//ul[@id='hightlights']/li/span</xpath>
    </collection>
    
    <!-- Detailed specs -->
    <collection name="specifications_table">
      <xpath>//div[@id='Specs']/fieldset</xpath>
      <scalar name="title">
        <xpath>./h3</xpath>
      </scalar>
      <collection name="specifications">
        <xpath>./dl</xpath>
        <scalar name="name">
          <xpath>./dt</xpath>
        </scalar>
        <scalar name="value">
          <xpath>./dd</xpath>
        </scalar>
      </collection>
    </collection>
  </meta_metadata>
  
  

  <meta_metadata name="newegg_subcategory_list" extends="compound_document" parser="xpath"
    user_agent_name="chrome">
    <selector url_regex="http://www.newegg.com/.*/SubCategory/.*" domain="newegg.com"/>
    <example_url url="http://www.newegg.com/All-Laptops-Notebooks/SubCategory/ID-32?Pagesize=100" />

    <scalar name="title">
      <xpath>//div[@class='recordCount']</xpath>
    </scalar>
		
    <collection name="items" child_type="newegg_product">
      <xpath>//div[@class='itemCell']</xpath>
      <scalar name="title">
        <xpath>.//span[@class='itemDescription']</xpath>
      </scalar>
      <scalar name="location">
        <xpath>.//div[@class='wrapper']/a/@href</xpath>
      </scalar>
      <collection name="specifications_table">
        <xpath>//ul[@class='featureList']</xpath>
        <collection name="specifications">
          <xpath>./li</xpath>
          <scalar name="name">
            <xpath>./b</xpath>
          </scalar>
          <scalar name="value">
            <xpath>.</xpath>
            <regex_op regex="^[^:]+:" replace="" />
          </scalar>
        </collection>
      </collection>
    </collection>
    
  </meta_metadata>
  
  <meta_metadata name="samsclub_product" extends="product" parser="xpath"
    user_agent_name="firefox">
    <selector url_path_tree="http://www.samsclub.com/sams/" domain="samsclub.com" />

    <example_url
      url="http://www.samsclub.com/sams/cortina-pub-back-reclining-living-room-3-pcs/prod2360758.ip?navAction=push" />

    <scalar name="title">
      <xpath>//span[@itemprop='name']</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//div[@itemprop='description']/p</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@class='leftVal onlinePrice']</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//div[@id='plImageHolder']/img/@src</xpath>
      </scalar>
    </collection>

  </meta_metadata>

  <meta_metadata name="samsclub_mobile_product" type="product" parser="xpath"
    user_agent_name="firefox">
    <selector url_path_tree="http://m.samsclub.com/ip/" />
    <example_url url="http://m.samsclub.com/ip/showtime-reclining-sectional-with-console-storage/180248" />
    <scalar name="title">
      <xpath>//h1[@itemprop='name']</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//div[@itemprop='price']</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//img[@itemprop='image']/@src</xpath>
      </scalar>
    </collection>
  </meta_metadata>
  
  
  <meta_metadata name="target_product" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_path_tree="http://www.target.com/p/" />
    <example_url
      url="http://www.target.com/p/keurig-elite-single-cup-home-brewing-system-k40/-/A-10174593#prodSlot=medium_1_1" />

    <scalar name="title">
      <xpath>//h2[@class='product-name item']/span[@class='fn']</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//p[@class='context-buttom-gap tabtextfont'] | //ul[@class='context-buttom-gap
        innerlistings']
      </xpath>
    </scalar>
    <scalar name="price">
      <xpath>//p[@class='price']/span[@class='offerPrice']</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//img[@id='heroImage']/@src</xpath>
      </scalar>
    </collection>

    <def_var name="rating_summary" type="node">
      <xpath>//div[@class='ratings']</xpath>
    </def_var>
    <scalar name="overall_rating" context_node="rating_summary">
      <xpath>.//span[@class='rating']</xpath>
    </scalar>
    <scalar name="num_reviews" context_node="rating_summary">
      <xpath>.//a[@class='rating-count']/span</xpath>
    </scalar>
    <scalar name="reviews_location" context_node="rating_summary">
      <xpath>.//a[@class='rating-count']/@href</xpath>
    </scalar>

    <collection name="reviews">
      <xpath>//div[@id='ReviewsSection']//div[@class='review-srch-list']</xpath>
      <scalar name="rating">
        <xpath>.//div[@class='pro-overall-stars']//div[@class='rating-small fivestar']</xpath>
      </scalar>
      <scalar name="title">
        <xpath>.//div[@class='review-heading']</xpath>
      </scalar>
      <scalar name="description">
        <xpath>.//p[@class='review-text']</xpath>
      </scalar>
    </collection>

    <collection name="companion_products" child_type="target_product">
      <xpath>//ul[@class='borderContainer']//div[@class='product-container']</xpath>
      <scalar name="location">
        <xpath>.//p[@class='productLink-container']/a[@class='waRRtag']/@href</xpath>
      </scalar>
      <scalar name="title">
        <xpath>.//p[@class='productLink-container']/a[@class='waRRtag']</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>.//div[@class='rating-container']//div[@class='rating-small fivestar']</xpath>
      </scalar>
      <scalar name="price">
        <xpath>.//p[@class='price-container']</xpath>
      </scalar>
    </collection>
  </meta_metadata>

  <meta_metadata name="target_mobile_product" type="product" parser="xpath"
    user_agent_name="firefox">
    <selector url_path_tree="http://m.target.com/p/" />
    <example_url url="http://m.target.com/p/threshold-farrah-fretwork-window-panel/-/A-13976559" />

    <scalar name="title">
      <xpath>//h2</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//ul[@class='feature-details']</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//small[@id='pdpPriceSpan']</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//div[@class='product-img']/img/@src</xpath>
      </scalar>
    </collection>

    <scalar name="overall_rating">
      <xpath>//a[@class='group ratings-reviews']/span[1]/@class</xpath>
      <regex_op regex="rating stars-" replace="" />
    </scalar>
  </meta_metadata>
  
  

  <meta_metadata name="tigerdirect_product" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_stripped="http://www.tigerdirect.com/applications/SearchTools/item-details.asp" />
    <example_url
      url="http://www.tigerdirect.com/applications/SearchTools/item-details.asp?EdpNo=8674056" />

    <collection name="main_images">
      <scalar name="location">
        <xpath>//img[@id='detailImg']/@src</xpath>
      </scalar>
    </collection>

    <scalar name="title">
      <xpath>//h1</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//span[@class='salePrice']</xpath>
    </scalar>
    <scalar name="overall_rating">
      <xpath>//span[@class='piRatingVal']</xpath>
      <regex_op regex="$" replace=" out of 5" />
    </scalar>
    <scalar name="description">
      <xpath>//div[@id='WriteUp']/div</xpath>
    </scalar>

    <collection name="reviews">
      <xpath>//div[@id='customerReviews']/div[@class='review']</xpath>
      <scalar name="title">
        <xpath>.//h6</xpath>
      </scalar>
      <scalar name="rating">
        <xpath>.//div[@class='itemRating']/strong</xpath>
      </scalar>
      <scalar name="description">
        <xpath>.//p</xpath>
      </scalar>
    </collection>
  </meta_metadata>
  
  <meta_metadata name="walmart_product" extends="product" parser="xpath"
    user_agent_name="chrome">
    <selector url_path_tree="http://www.walmart.com/ip/" />
    <example_url
      url="http://www.walmart.com/ip/The-Hobbit-An-Unexpected-Journey-DVD-UltraViolet-Widescreen/23263613" />
    <example_url url="http://www.walmart.com/ip/Twister-Dance/21097609" />

    <scalar name="title">
      <xpath>//h1[@class='productTitle']</xpath>
    </scalar>
    <scalar name="description">
      <xpath>//div[@id='SITCC_1column']</xpath>
    </scalar>
    <scalar name="price">
      <xpath>//div[@id='WM_PRICE']//span[@class='clearfix camelPrice ']</xpath>
    </scalar>

    <collection name="main_images">
      <scalar name="location">
        <xpath>//div[@class='LargeItemPhoto215']//img/@src</xpath>
      </scalar>
    </collection>

    <def_var name="rating_summary" type="node">
      <xpath>//div[@class='CustomerRatings']</xpath>
    </def_var>
    <scalar name="overall_rating" context_node="rating_summary">
      <xpath>.//div[@class='BVRROverallRatingContainer']//img/@alt</xpath>
    </scalar>
    <scalar name="num_reviews" context_node="rating_summary">
      <xpath>.//div[@class='BVRRRatingSummaryLinks']//span[@class='BVRRNumber']</xpath>
    </scalar>
    <scalar name="reviews_location" context_node="rating_summary">
      <xpath>.//span[@class='BVRRRatingSummaryLinkReadWithCountID']/a/@href</xpath>
    </scalar>

    <collection name="reviews">
      <xpath>//div[@class='BVRRReviewDisplayStyle3Main']</xpath>
      <scalar name="rating">
        <xpath>.//div[@class='BVRROverallRatingContainer']//img/@alt</xpath>
      </scalar>
      <scalar name="title">
        <xpath>.//span[@class='BVRRValue BVRRReviewTitle']</xpath>
      </scalar>
      <scalar name="time">
        <xpath>.//span[@class='BVRRValue BVRRReviewDate']</xpath>
      </scalar>
      <scalar name="description">
        <xpath>.//span[@class='BVRRReviewText']</xpath>
      </scalar>
    </collection>

    <collection name="companion_products" child_type="walmart_product">
      <xpath>//div[@class='prtHid']//div[@id='rr_placement_2']</xpath>
      <scalar name="location">
        <xpath>.//a/@href</xpath>
      </scalar>
      <scalar name="title">
        <xpath>.//a</xpath>
      </scalar>
      <scalar name="overall_rating">
        <xpath>./div[@class='wmStars rrStars']/div/@title</xpath>
      </scalar>
      <!-- <scalar name="price" xpath=".//div[@class='price']" /> -->
    </collection>
  </meta_metadata>
  
  
  
  
</meta_metadata_repository>